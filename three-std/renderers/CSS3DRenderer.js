!function(){var e,t;e=this,t=function(e,t){"use strict";const n=new t.Vector3,r=new t.Quaternion,s=new t.Vector3;class o extends t.Object3D{constructor(e=document.createElement("div")){super(),this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}o.prototype.isCSS3DObject=!0;class i extends o{constructor(e){super(e),this.rotation2D=0}copy(e,t){return super.copy(e,t),this.rotation2D=e.rotation2D,this}}i.prototype.isCSS3DSprite=!0;const l=new t.Matrix4,a=new t.Matrix4;e.CSS3DObject=o,e.CSS3DRenderer=class{constructor(e={}){const t=this;let o,i,c,d;const p={camera:{fov:0,style:""},objects:new WeakMap},m=void 0!==e.element?e.element:document.createElement("div");m.style.overflow="hidden",this.domElement=m;const u=document.createElement("div");function h(e){return Math.abs(e)<1e-10?0:e}function f(e){const t=e.elements;return"matrix3d("+h(t[0])+","+h(-t[1])+","+h(t[2])+","+h(t[3])+","+h(t[4])+","+h(-t[5])+","+h(t[6])+","+h(t[7])+","+h(t[8])+","+h(-t[9])+","+h(t[10])+","+h(t[11])+","+h(t[12])+","+h(-t[13])+","+h(t[14])+","+h(t[15])+")"}function y(e){const t=e.elements;return"translate(-50%,-50%)matrix3d("+h(t[0])+","+h(t[1])+","+h(t[2])+","+h(t[3])+","+h(-t[4])+","+h(-t[5])+","+h(-t[6])+","+h(-t[7])+","+h(t[8])+","+h(t[9])+","+h(t[10])+","+h(t[11])+","+h(t[12])+","+h(t[13])+","+h(t[14])+","+h(t[15])+")"}function x(e,o,i,c){if(e.isCSS3DObject){const c=!0===e.visible&&!0===e.layers.test(i.layers);if(e.element.style.display=!0===c?"":"none",!0===c){let c;e.onBeforeRender(t,o,i),e.isCSS3DSprite?(l.copy(i.matrixWorldInverse),l.transpose(),0!==e.rotation2D&&l.multiply(a.makeRotationZ(e.rotation2D)),e.matrixWorld.decompose(n,r,s),l.setPosition(n),l.scale(s),l.elements[3]=0,l.elements[7]=0,l.elements[11]=0,l.elements[15]=1,c=y(l)):c=y(e.matrixWorld);const d=e.element,m=p.objects.get(e);if(void 0===m||m.style!==c){d.style.transform=c;const t={style:c};p.objects.set(e,t)}d.parentNode!==u&&u.appendChild(d),e.onAfterRender(t,o,i)}}for(let t=0,n=e.children.length;t<n;t++)x(e.children[t],o,i,c)}u.style.transformStyle="preserve-3d",u.style.pointerEvents="none",m.appendChild(u),this.getSize=function(){return{width:o,height:i}},this.render=function(e,t){const n=t.projectionMatrix.elements[5]*d;let r,s;p.camera.fov!==n&&(m.style.perspective=t.isPerspectiveCamera?n+"px":"",p.camera.fov=n),!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),t.isOrthographicCamera&&(r=-(t.right+t.left)/2,s=(t.top+t.bottom)/2);const o=t.isOrthographicCamera?"scale("+n+")translate("+h(r)+"px,"+h(s)+"px)"+f(t.matrixWorldInverse):"translateZ("+n+"px)"+f(t.matrixWorldInverse),i=o+"translate("+c+"px,"+d+"px)";p.camera.style!==i&&(u.style.transform=i,p.camera.style=i),x(e,e,t,o)},this.setSize=function(e,t){o=e,i=t,c=o/2,d=i/2,m.style.width=e+"px",m.style.height=t+"px",u.style.width=e+"px",u.style.height=t+"px"}}},e.CSS3DSprite=i,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).THREE=e["THREE-STD"]||{},e.THREE)}();
