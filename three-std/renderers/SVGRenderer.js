!function(){var e,t;e=this,t=function(e,t,i){"use strict";class o extends t.Object3D{constructor(e){super(),this.node=e}}o.prototype.isSVGObject=!0,e.SVGObject=o,e.SVGRenderer=class{constructor(){let e,o,n,r,s,c,a,l,p,d,f,h,u,S=0,y=null,m=1;const x=this,g=new t.Box2,w=new t.Box2,b=new t.Color,M=new t.Color,v=new t.Color,z=new t.Color,C=new t.Color,E=new t.Color,j=new t.Vector3,P=new t.Vector3,k=new t.Vector3,L=new t.Matrix3,R=new t.Matrix4,B=new t.Matrix4,V=[],G=new i.Projector,T=document.createElementNS("http://www.w3.org/2000/svg","svg");function A(){for(S=0;T.childNodes.length>0;)T.removeChild(T.childNodes[0])}function W(e){return null!==y?e.toFixed(y):e}function F(e,t,i){let o=t.scale.x*c,n=t.scale.y*a;i.isPointsMaterial&&(o*=i.size,n*=i.size);const r="M"+W(e.x-.5*o)+","+W(e.y-.5*n)+"h"+W(o)+"v"+W(n)+"h"+W(-o)+"z";let s="";(i.isSpriteMaterial||i.isPointsMaterial)&&(s="fill:"+i.color.getStyle()+";fill-opacity:"+i.opacity),H(s,r)}function O(e,t,i){const o="M"+W(e.positionScreen.x)+","+W(e.positionScreen.y)+"L"+W(t.positionScreen.x)+","+W(t.positionScreen.y);if(i.isLineBasicMaterial){let e="fill:none;stroke:"+i.color.getStyle()+";stroke-opacity:"+i.opacity+";stroke-width:"+i.linewidth+";stroke-linecap:"+i.linecap;i.isLineDashedMaterial&&(e=e+";stroke-dasharray:"+i.dashSize+","+i.gapSize),H(e,o)}}function N(e,t,i,o,r){x.info.render.vertices+=3,x.info.render.faces++;const s="M"+W(e.positionScreen.x)+","+W(e.positionScreen.y)+"L"+W(t.positionScreen.x)+","+W(t.positionScreen.y)+"L"+W(i.positionScreen.x)+","+W(i.positionScreen.y)+"z";let c="";r.isMeshBasicMaterial?(b.copy(r.color),r.vertexColors&&b.multiply(o.color)):r.isMeshLambertMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial?(M.copy(r.color),r.vertexColors&&M.multiply(o.color),b.copy(v),P.copy(e.positionWorld).add(t.positionWorld).add(i.positionWorld).divideScalar(3),function(e,t,i,o){for(let n=0,r=e.length;n<r;n++){const r=e[n],s=r.color;if(r.isDirectionalLight){const e=j.setFromMatrixPosition(r.matrixWorld).normalize();let t=i.dot(e);if(t<=0)continue;t*=r.intensity,o.r+=s.r*t,o.g+=s.g*t,o.b+=s.b*t}else if(r.isPointLight){const e=j.setFromMatrixPosition(r.matrixWorld);let n=i.dot(j.subVectors(e,t).normalize());if(n<=0)continue;if(n*=0==r.distance?1:1-Math.min(t.distanceTo(e)/r.distance,1),0==n)continue;n*=r.intensity,o.r+=s.r*n,o.g+=s.g*n,o.b+=s.b*n}}}(n,P,o.normalModel,b),b.multiply(M).add(r.emissive)):r.isMeshNormalMaterial&&(k.copy(o.normalModel).applyMatrix3(L).normalize(),b.setRGB(k.x,k.y,k.z).multiplyScalar(.5).addScalar(.5)),c=r.wireframe?"fill:none;stroke:"+b.getStyle()+";stroke-opacity:"+r.opacity+";stroke-width:"+r.wireframeLinewidth+";stroke-linecap:"+r.wireframeLinecap+";stroke-linejoin:"+r.wireframeLinejoin:"fill:"+b.getStyle()+";fill-opacity:"+r.opacity,H(c,s)}function D(e,t,i){let o=t.x-e.x,n=t.y-e.y;const r=o*o+n*n;if(0===r)return;const s=i/Math.sqrt(r);o*=s,n*=s,t.x+=o,t.y+=n,e.x-=o,e.y-=n}function H(e,t){u===e?h+=t:(q(),u=e,h=t)}function q(){var e;h&&(e=S++,f=null==V[e]?(V[e]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==m&&V[e].setAttribute("shape-rendering","crispEdges"),V[e]):V[e],f.setAttribute("d",h),f.setAttribute("style",u),T.appendChild(f)),h="",u=""}this.domElement=T,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.overdraw=.5,this.info={render:{vertices:0,faces:0}},this.setQuality=function(e){switch(e){case"high":m=1;break;case"low":m=0}},this.setClearColor=function(e){E.set(e)},this.setPixelRatio=function(){},this.setSize=function(e,t){r=e,s=t,c=r/2,a=s/2,T.setAttribute("viewBox",-c+" "+-a+" "+r+" "+s),T.setAttribute("width",r),T.setAttribute("height",s),g.min.set(-c,-a),g.max.set(c,a)},this.getSize=function(){return{width:r,height:s}},this.setPrecision=function(e){y=e},this.clear=function(){A(),T.style.backgroundColor=E.getStyle()},this.render=function(r,s){if(s instanceof t.Camera==0)return void console.error("THREE.SVGRenderer.render: camera is not an instance of Camera.");const f=r.background;f&&f.isColor?(A(),T.style.backgroundColor=f.getStyle()):!0===this.autoClear&&this.clear(),x.info.render.vertices=0,x.info.render.faces=0,R.copy(s.matrixWorldInverse),B.multiplyMatrices(s.projectionMatrix,R),e=G.projectScene(r,s,this.sortObjects,this.sortElements),o=e.elements,n=e.lights,L.getNormalMatrix(s.matrixWorldInverse),function(e){v.setRGB(0,0,0),z.setRGB(0,0,0),C.setRGB(0,0,0);for(let t=0,i=e.length;t<i;t++){const i=e[t],o=i.color;i.isAmbientLight?(v.r+=o.r,v.g+=o.g,v.b+=o.b):i.isDirectionalLight?(z.r+=o.r,z.g+=o.g,z.b+=o.b):i.isPointLight&&(C.r+=o.r,C.g+=o.g,C.b+=o.b)}}(n),h="",u="";for(let e=0,t=o.length;e<t;e++){const t=o[e],n=t.material;if(void 0!==n&&0!==n.opacity)if(w.makeEmpty(),t instanceof i.RenderableSprite)l=t,l.x*=c,l.y*=-a,F(l,t,n);else if(t instanceof i.RenderableLine)l=t.v1,p=t.v2,l.positionScreen.x*=c,l.positionScreen.y*=-a,p.positionScreen.x*=c,p.positionScreen.y*=-a,w.setFromPoints([l.positionScreen,p.positionScreen]),!0===g.intersectsBox(w)&&O(l,p,n);else if(t instanceof i.RenderableFace){if(l=t.v1,p=t.v2,d=t.v3,l.positionScreen.z<-1||l.positionScreen.z>1)continue;if(p.positionScreen.z<-1||p.positionScreen.z>1)continue;if(d.positionScreen.z<-1||d.positionScreen.z>1)continue;l.positionScreen.x*=c,l.positionScreen.y*=-a,p.positionScreen.x*=c,p.positionScreen.y*=-a,d.positionScreen.x*=c,d.positionScreen.y*=-a,this.overdraw>0&&(D(l.positionScreen,p.positionScreen,this.overdraw),D(p.positionScreen,d.positionScreen,this.overdraw),D(d.positionScreen,l.positionScreen,this.overdraw)),w.setFromPoints([l.positionScreen,p.positionScreen,d.positionScreen]),!0===g.intersectsBox(w)&&N(l,p,d,t,n)}}q(),r.traverseVisible((function(e){if(e.isSVGObject){if(j.setFromMatrixPosition(e.matrixWorld),j.applyMatrix4(B),j.z<-1||j.z>1)return;const t=j.x*c,i=-j.y*a,o=e.node;o.setAttribute("transform","translate("+t+","+i+")"),T.appendChild(o)}}))}}},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three"),require("./Projector.js")):"function"==typeof define&&define.amd?define(["exports","three","./Projector"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).THREE=e["THREE-STD"]||{},e.THREE,e.THREE)}();
