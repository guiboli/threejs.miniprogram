!function(){var e,t;e=this,t=function(e,t){"use strict";function n(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var o=n(t);function i(e,t,n,o){const i=t.x,s=t.y,r=t.z,c=t.w,d=i+i,a=s+s,y=r+r,p=i*d,f=i*a,u=i*y,h=s*a,g=s*y,l=r*y,w=c*d,m=c*a,M=c*y;n[o+0]=1-(h+l),n[o+1]=f+M,n[o+2]=u-m,n[o+3]=0,n[o+4]=f-M,n[o+5]=1-(p+l),n[o+6]=g+w,n[o+7]=0,n[o+8]=u+m,n[o+9]=g-w,n[o+10]=1-(p+h),n[o+11]=0,n[o+12]=e.x,n[o+13]=e.y,n[o+14]=e.z,n[o+15]=1}e.OimoPhysics=async function(){const e=new o.World(2,new o.Vec3(0,-9.8,0)),t=[],n=new WeakMap;let s=0;return setInterval((function(){const o=performance.now();s>0&&e.step(1/60),s=o;for(let e=0,o=t.length;e<o;e++){const o=t[e];if(o.isInstancedMesh){const e=o.instanceMatrix.array,t=n.get(o);for(let n=0;n<t.length;n++){const o=t[n];i(o.getPosition(),o.getOrientation(),e,16*n)}o.instanceMatrix.needsUpdate=!0}else if(o.isMesh){const e=n.get(o);o.position.copy(e.getPosition()),o.quaternion.copy(e.getOrientation())}}}),1e3/60),{addMesh:function(i,s=0){const r=function(e){const t=e.parameters;if("BoxGeometry"===e.type){const e=void 0!==t.width?t.width/2:.5,n=void 0!==t.height?t.height/2:.5,i=void 0!==t.depth?t.depth/2:.5;return new o.OBoxGeometry(new o.Vec3(e,n,i))}if("SphereGeometry"===e.type||"IcosahedronGeometry"===e.type){const e=void 0!==t.radius?t.radius:1;return new o.OSphereGeometry(e)}return null}(i.geometry);null!==r&&(i.isInstancedMesh?function(i,s,r){const c=i.instanceMatrix.array,d=[];for(let t=0;t<i.count;t++){const n=16*t,i=new o.ShapeConfig;i.geometry=r;const a=new o.RigidBodyConfig;a.type=0===s?o.RigidBodyType.STATIC:o.RigidBodyType.DYNAMIC,a.position=new o.Vec3(c[n+12],c[n+13],c[n+14]);const y=new o.RigidBody(a);y.addShape(new o.Shape(i)),e.addRigidBody(y),d.push(y)}s>0&&(t.push(i),n.set(i,d))}(i,s,r):i.isMesh&&function(i,s,r){const c=new o.ShapeConfig;c.geometry=r;const d=new o.RigidBodyConfig;d.type=0===s?o.RigidBodyType.STATIC:o.RigidBodyType.DYNAMIC,d.position=new o.Vec3(i.position.x,i.position.y,i.position.z);const a=new o.RigidBody(d);a.addShape(new o.Shape(c)),e.addRigidBody(a),s>0&&(t.push(i),n.set(i,a))}(i,s,r))},setMeshPosition:function(e,t,i=0){e.isInstancedMesh?n.get(e)[i].setPosition(new o.Vec3(t.x,t.y,t.z)):e.isMesh&&n.get(e).setPosition(new o.Vec3(t.x,t.y,t.z))}}},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("../libs/OimoPhysics/index.js")):"function"==typeof define&&define.amd?define(["exports","../libs/OimoPhysics/index"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).THREE=e["THREE-STD"]||{},e.THREE)}();
