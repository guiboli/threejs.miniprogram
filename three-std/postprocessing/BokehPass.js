!function(){var e,r;e=this,r=function(e,r,t,a){"use strict";class s extends t.Pass{constructor(e,s,i){super(),this.scene=e,this.camera=s;const l=void 0!==i.focus?i.focus:1,h=void 0!==i.aspect?i.aspect:s.aspect,n=void 0!==i.aperture?i.aperture:.025,o=void 0!==i.maxblur?i.maxblur:1,d=i.width||window.innerWidth||1,u=i.height||window.innerHeight||1;this.renderTargetDepth=new r.WebGLRenderTarget(d,u,{minFilter:r.NearestFilter,magFilter:r.NearestFilter}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new r.MeshDepthMaterial,this.materialDepth.depthPacking=r.RGBADepthPacking,this.materialDepth.blending=r.NoBlending,void 0===a.BokehShader&&console.error("THREE.BokehPass relies on BokehShader");const p=a.BokehShader,c=r.UniformsUtils.clone(p.uniforms);c.tDepth.value=this.renderTargetDepth.texture,c.focus.value=l,c.aspect.value=h,c.aperture.value=n,c.maxblur.value=o,c.nearClip.value=s.near,c.farClip.value=s.far,this.materialBokeh=new r.ShaderMaterial({defines:Object.assign({},p.defines),uniforms:c,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader}),this.uniforms=c,this.needsSwap=!1,this.fsQuad=new t.FullScreenQuad(this.materialBokeh),this._oldClearColor=new r.Color}render(e,r,t){this.scene.overrideMaterial=this.materialDepth,e.getClearColor(this._oldClearColor);const a=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=t.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this._oldClearColor),e.setClearAlpha(a),e.autoClear=s}}e.BokehPass=s,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("three"),require("./Pass.js"),require("../shaders/BokehShader.js")):"function"==typeof define&&define.amd?define(["exports","three","./Pass","../shaders/BokehShader"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).THREE=e["THREE-STD"]||{},e.THREE,e.THREE,e.THREE)}();
