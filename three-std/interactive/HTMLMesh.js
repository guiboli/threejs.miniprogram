!function(){var e,t;e=this,t=function(e,t){"use strict";class n extends t.Mesh{constructor(e){const n=new o(e),i=new t.PlaneGeometry(.001*n.image.width,.001*n.image.height),s=new t.MeshBasicMaterial({map:n,toneMapped:!1});function d(e){s.map.dispatchDOMEvent(e)}super(i,s),this.addEventListener("mousedown",d),this.addEventListener("mousemove",d),this.addEventListener("mouseup",d),this.addEventListener("click",d),this.dispose=function(){i.dispose(),s.dispose(),s.map.dispose(),this.removeEventListener("mousedown",d),this.removeEventListener("mousemove",d),this.removeEventListener("mouseup",d),this.removeEventListener("click",d)}}}class o extends t.CanvasTexture{constructor(e){super(s(e)),this.dom=e,this.anisotropy=16,this.encoding=t.sRGBEncoding,this.minFilter=t.LinearFilter,this.magFilter=t.LinearFilter;const n=new MutationObserver((()=>{this.scheduleUpdate||(this.scheduleUpdate=setTimeout((()=>this.update()),16))}));n.observe(e,{attributes:!0,childList:!0,subtree:!0,characterData:!0}),this.observer=n}dispatchDOMEvent(e){e.data&&function(e,t,n,o){const i={clientX:n*e.offsetWidth+e.offsetLeft,clientY:o*e.offsetHeight+e.offsetTop,view:e.ownerDocument.defaultView};window.dispatchEvent(new MouseEvent(t,i));const s=e.getBoundingClientRect();function d(e){if(3!==e.nodeType){const s=e.getBoundingClientRect();n>s.left&&n<s.right&&o>s.top&&o<s.bottom&&e.dispatchEvent(new MouseEvent(t,i));for(let t=0;t<e.childNodes.length;t++)d(e.childNodes[t])}}n=n*s.width+s.left,o=o*s.height+s.top,d(e)}(this.dom,e.type,e.data.x,e.data.y)}update(){this.image=s(this.dom),this.needsUpdate=!0,this.scheduleUpdate=null}dispose(){this.observer&&this.observer.disconnect(),this.scheduleUpdate=clearTimeout(this.scheduleUpdate),super.dispose()}}const i=new WeakMap;function s(e){const t=document.createRange();function n(e,t,n,o){""!==o&&("uppercase"===e.textTransform&&(o=o.toUpperCase()),r.font=e.fontSize+" "+e.fontFamily,r.textBaseline="top",r.fillStyle=e.color,r.fillText(o,t,n))}function o(e,t,n,o,i,s){const d=e[t+"Width"],a=e[t+"Style"],h=e[t+"Color"];"0px"!==d&&"none"!==a&&"transparent"!==h&&"rgba(0, 0, 0, 0)"!==h&&(r.strokeStyle=h,r.beginPath(),r.moveTo(n,o),r.lineTo(n+i,o+s),r.stroke())}const s=e.getBoundingClientRect();let d;i.has(e)?d=i.get(e):(d=document.createElement("canvas"),d.width=s.width,d.height=s.height);const r=d.getContext("2d"),a=new function(e){const t=[];let n=!1;function o(){if(n&&(n=!1,e.restore()),0===t.length)return;let o=-1/0,i=-1/0,s=1/0,d=1/0;for(let e=0;e<t.length;e++){const n=t[e];o=Math.max(o,n.x),i=Math.max(i,n.y),s=Math.min(s,n.x+n.width),d=Math.min(d,n.y+n.height)}e.save(),e.beginPath(),e.rect(o,i,s-o,d-i),e.clip(),n=!0}return{add:function(e){t.push(e),o()},remove:function(){t.pop(),o()}}}(r);return function e(i,d){let h=0,l=0,c=0,u=0;if(3===i.nodeType){t.selectNode(i);const e=t.getBoundingClientRect();h=e.left-s.left-.5,l=e.top-s.top-.5,c=e.width,u=e.height,n(d,h,l,i.nodeValue.trim())}else if(i instanceof HTMLCanvasElement){if("none"===i.style.display)return;r.save();const e=window.devicePixelRatio;r.scale(1/e,1/e),r.drawImage(i,0,0),r.restore()}else{if("none"===i.style.display)return;const e=i.getBoundingClientRect();h=e.left-s.left-.5,l=e.top-s.top-.5,c=e.width,u=e.height;const t=(d=window.getComputedStyle(i)).backgroundColor;"transparent"!==t&&"rgba(0, 0, 0, 0)"!==t&&(r.fillStyle=t,r.fillRect(h,l,c,u)),o(d,"borderTop",h,l,c,0),o(d,"borderLeft",h,l,0,u),o(d,"borderBottom",h,l+u,c,0),o(d,"borderRight",h+c,l,0,u),"color"!==i.type&&"text"!==i.type&&"number"!==i.type||(a.add({x:h,y:l,width:c,height:u}),n(d,h+parseInt(d.paddingLeft),l+parseInt(d.paddingTop),i.value),a.remove())}const p="auto"===d.overflow||"hidden"===d.overflow;p&&a.add({x:h,y:l,width:c,height:u});for(let t=0;t<i.childNodes.length;t++)e(i.childNodes[t],d);p&&a.remove()}(e),d}e.HTMLMesh=n,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).THREE=e["THREE-STD"]||{},e.THREE)}();
