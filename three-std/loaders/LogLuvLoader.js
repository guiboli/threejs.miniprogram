!function(){var t,r;t=this,r=function(t,r){"use strict";class e extends r.DataTextureLoader{constructor(t){super(t),this.type=r.HalfFloatType}parse(t){const e=n.decode(t);n.decodeImage(t,e[0]);const i=n.toRGBA(e[0],this.type);return{width:e[0].width,height:e[0].height,data:i,format:r.RGBAFormat,type:this.type,flipY:!0}}setDataType(t){return this.type=t,this}}const n={decode:function(t,r){null==r&&(r={parseMN:!0,debug:!1});var e=new Uint8Array(t),i=0,a=n._binBE.readASCII(e,i,2);i+=2;var o="II"==a?n._binLE:n._binBE;o.readUshort(e,i),i+=2;for(var f=o.readUint(e,i),u=[];;){var l=o.readUshort(e,f),d=o.readUshort(e,f+4);if(0!=l&&(d<1||13<d)){console.log("error in TIFF");break}if(n._readIFD(o,e,f,u,0,r),0==(f=o.readUint(e,f+2+12*l)))break}return u},decodeImage:function(t,r,e){if(!r.data){var i=new Uint8Array(t),a=n._binBE.readASCII(i,0,2);if(null!=r.t256){r.isLE="II"==a,r.width=r.t256[0],r.height=r.t257[0];var o,f=r.t259?r.t259[0]:1,u=r.t266?r.t266[0]:1;r.t284&&2==r.t284[0]&&console.log("PlanarConfiguration 2 should not be used!"),7==f&&r.t258&&r.t258.length>3&&(r.t258=r.t258.slice(0,3)),o=r.t258?Math.min(32,r.t258[0])*r.t258.length:r.t277?r.t277[0]:1,1==f&&null!=r.t279&&r.t278&&32803==r.t262[0]&&(o=Math.round(8*r.t279[0]/(r.width*r.t278[0])));var l=8*Math.ceil(r.width*o/8),d=r.t273;null==d&&(d=r.t324);var h=r.t279;1==f&&1==d.length&&(h=[r.height*(l>>>3)]),null==h&&(h=r.t325);var s=new Uint8Array(r.height*(l>>>3)),c=0;if(null!=r.t322){for(var b=r.t322[0],v=r.t323[0],_=Math.floor((r.width+b-1)/b),E=Math.floor((r.height+v-1)/v),p=new Uint8Array(0|Math.ceil(b*v*o/8)),g=0;g<E;g++)for(var B=0;B<_;B++){for(var I=g*_+B,U=0;U<p.length;U++)p[U]=0;n.decode._decompress(r,e,i,d[I],h[I],f,p,0,u),6==f?s=p:n._copyTile(p,0|Math.ceil(b*o/8),v,s,0|Math.ceil(r.width*o/8),r.height,0|Math.ceil(B*b*o/8),g*v)}c=8*s.length}else{var w=r.t278?r.t278[0]:r.height;for(w=Math.min(w,r.height),I=0;I<d.length;I++)n.decode._decompress(r,e,i,d[I],h[I],f,s,0|Math.ceil(c/8),u),c+=l*w;c=Math.min(c,8*s.length)}r.data=new Uint8Array(s.buffer,0,0|Math.ceil(c/8))}}}};var i;n.decode._decompress=function(t,r,e,i,a,o,f,u){34676==o?n.decode._decodeLogLuv32(t,e,i,a,f,u):console.log("Unsupported compression",o);var l=t.t258?Math.min(32,t.t258[0]):1,d=t.t277?t.t277[0]:1,h=l*d>>>3,s=t.t278?t.t278[0]:t.height,c=Math.ceil(l*d*t.width/8);if(16==l&&!t.isLE&&null==t.t33422)for(var b=0;b<s;b++)for(var v=u+b*c,_=1;_<c;_+=2){var E=f[v+_];f[v+_]=f[v+_-1],f[v+_-1]=E}if(t.t317&&2==t.t317[0])for(b=0;b<s;b++){var p=u+b*c;if(16==l)for(var g=h;g<c;g+=2){var B=(f[p+g+1]<<8|f[p+g])+(f[p+g-h+1]<<8|f[p+g-h]);f[p+g]=255&B,f[p+g+1]=B>>>8&255}else if(3==d)for(g=3;g<c;g+=3)f[p+g]=f[p+g]+f[p+g-3]&255,f[p+g+1]=f[p+g+1]+f[p+g-2]&255,f[p+g+2]=f[p+g+2]+f[p+g-1]&255;else for(g=h;g<c;g++)f[p+g]=f[p+g]+f[p+g-h]&255}},n.decode._decodeLogLuv32=function(t,r,e,n,i,a){for(var o=t.width,f=4*o,u=0,l=new Uint8Array(f);u<n;){for(var d=0;d<f;){var h=r[e+u];if(u++,h<128){for(var s=0;s<h;s++)l[d+s]=r[e+u+s];d+=h,u+=h}else{for(h-=126,s=0;s<h;s++)l[d+s]=r[e+u];d+=h,u++}}for(var c=0;c<o;c++)i[a+0]=l[c],i[a+1]=l[c+o],i[a+2]=l[c+2*o],i[a+4]=l[c+3*o],a+=6}},n.tags={},n._types=((i=new Array(250)).fill(0),{basic:{main:i=i.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}),n._readIFD=function(t,r,e,i,a,o){var f=t.readUshort(r,e);e+=2;var u={};o.debug&&console.log("   ".repeat(a),i.length-1,">>>----------------");for(var l=0;l<f;l++){var d=t.readUshort(r,e);e+=2;var h=t.readUshort(r,e);e+=2;var s=t.readUint(r,e);e+=4;var c=t.readUint(r,e);e+=4;var b=[];if(1!=h&&7!=h||(b=new Uint8Array(r.buffer,s<5?e-4:c,s)),2==h){var v=s<5?e-4:c,_=r[v],E=Math.max(0,Math.min(s-1,r.length-v));_<128||0==E?b.push(t.readASCII(r,v,E)):b=new Uint8Array(r.buffer,v,E)}if(3==h)for(var p=0;p<s;p++)b.push(t.readUshort(r,(s<3?e-4:c)+2*p));if(4==h||13==h)for(p=0;p<s;p++)b.push(t.readUint(r,(s<2?e-4:c)+4*p));if(5==h||10==h){var g=5==h?t.readUint:t.readInt;for(p=0;p<s;p++)b.push([g(r,c+8*p),g(r,c+8*p+4)])}if(8==h)for(p=0;p<s;p++)b.push(t.readShort(r,(s<3?e-4:c)+2*p));if(9==h)for(p=0;p<s;p++)b.push(t.readInt(r,(s<2?e-4:c)+4*p));if(11==h)for(p=0;p<s;p++)b.push(t.readFloat(r,c+4*p));if(12==h)for(p=0;p<s;p++)b.push(t.readDouble(r,c+8*p));if(0==s||0!=b.length){if(o.debug&&console.log("   ".repeat(a),d,h,n.tags[d],b),u["t"+d]=b,330==d||34665==d||34853==d||50740==d&&t.readUshort(r,t.readUint(b,0))<300||61440==d){var B=50740==d?[t.readUint(b,0)]:b,I=[];for(p=0;p<B.length;p++)n._readIFD(t,r,B[p],I,a+1,o);330==d&&(u.subIFD=I),34665==d&&(u.exifIFD=I[0]),34853==d&&(u.gpsiIFD=I[0]),50740==d&&(u.dngPrvt=I[0]),61440==d&&(u.fujiIFD=I[0])}if(37500==d&&o.parseMN){var U=b;if("Nikon"==t.readASCII(U,0,5))u.makerNote=n.decode(U.slice(10).buffer)[0];else if(t.readUshort(r,c)<300&&t.readUshort(r,c+4)<=12){var w=[];n._readIFD(t,r,c,w,a+1,o),u.makerNote=w[0]}}}else if(console.log(d,"unknown TIFF tag type: ",h,"num:",s),0==l)return}return i.push(u),o.debug&&console.log("   ".repeat(a),"<<<---------------"),e},n.toRGBA=function(t,e){const n=t.width,i=t.height,a=n*i,o=t.data;let f;switch(e){case r.HalfFloatType:f=new Uint16Array(4*a);break;case r.FloatType:f=new Float32Array(4*a);break;default:console.error("THREE.LogLuvLoader: Unsupported texture data type:",e)}let u=t.t262?t.t262[0]:2;const l=t.t258?Math.min(32,t.t258[0]):1;if(null==t.t262&&1==l&&(u=0),32845==u)for(let t=0;t<i;t++)for(let i=0;i<n;i++){const a=6*(t*n+i),u=4*(t*n+i);let l=o[a+1]<<8|o[a];l=Math.pow(2,(l+.5)/256-64);const d=(o[a+3]+.5)/410,h=(o[a+5]+.5)/410,s=9*d/(6*d-16*h+12),c=4*h/(6*d-16*h+12),b=s*l/c,v=(1-s-c)*l/c,_=2.69*b-1.276*l-.414*v,E=-1.022*b+1.978*l+.044*v,p=.061*b-.224*l+1.163*v;e===r.HalfFloatType?(f[u]=r.DataUtils.toHalfFloat(Math.min(_,65504)),f[u+1]=r.DataUtils.toHalfFloat(Math.min(E,65504)),f[u+2]=r.DataUtils.toHalfFloat(Math.min(p,65504)),f[u+3]=r.DataUtils.toHalfFloat(1)):(f[u]=_,f[u+1]=E,f[u+2]=p,f[u+3]=1)}else console.log("Unsupported Photometric interpretation: "+u);return f},n._binBE={nextZero:function(t,r){for(;0!=t[r];)r++;return r},readUshort:function(t,r){return t[r]<<8|t[r+1]},readShort:function(t,r){var e=n._binBE.ui8;return e[0]=t[r+1],e[1]=t[r+0],n._binBE.i16[0]},readInt:function(t,r){var e=n._binBE.ui8;return e[0]=t[r+3],e[1]=t[r+2],e[2]=t[r+1],e[3]=t[r+0],n._binBE.i32[0]},readUint:function(t,r){var e=n._binBE.ui8;return e[0]=t[r+3],e[1]=t[r+2],e[2]=t[r+1],e[3]=t[r+0],n._binBE.ui32[0]},readASCII:function(t,r,e){for(var n="",i=0;i<e;i++)n+=String.fromCharCode(t[r+i]);return n},readFloat:function(t,r){for(var e=n._binBE.ui8,i=0;i<4;i++)e[i]=t[r+3-i];return n._binBE.fl32[0]},readDouble:function(t,r){for(var e=n._binBE.ui8,i=0;i<8;i++)e[i]=t[r+7-i];return n._binBE.fl64[0]},writeUshort:function(t,r,e){t[r]=e>>8&255,t[r+1]=255&e},writeInt:function(t,r,e){var i=n._binBE.ui8;n._binBE.i32[0]=e,t[r+3]=i[0],t[r+2]=i[1],t[r+1]=i[2],t[r+0]=i[3]},writeUint:function(t,r,e){t[r]=e>>24&255,t[r+1]=e>>16&255,t[r+2]=e>>8&255,t[r+3]=e>>0&255},writeASCII:function(t,r,e){for(var n=0;n<e.length;n++)t[r+n]=e.charCodeAt(n)},writeDouble:function(t,r,e){n._binBE.fl64[0]=e;for(var i=0;i<8;i++)t[r+i]=n._binBE.ui8[7-i]}},n._binBE.ui8=new Uint8Array(8),n._binBE.i16=new Int16Array(n._binBE.ui8.buffer),n._binBE.i32=new Int32Array(n._binBE.ui8.buffer),n._binBE.ui32=new Uint32Array(n._binBE.ui8.buffer),n._binBE.fl32=new Float32Array(n._binBE.ui8.buffer),n._binBE.fl64=new Float64Array(n._binBE.ui8.buffer),n._binLE={nextZero:n._binBE.nextZero,readUshort:function(t,r){return t[r+1]<<8|t[r]},readShort:function(t,r){var e=n._binBE.ui8;return e[0]=t[r+0],e[1]=t[r+1],n._binBE.i16[0]},readInt:function(t,r){var e=n._binBE.ui8;return e[0]=t[r+0],e[1]=t[r+1],e[2]=t[r+2],e[3]=t[r+3],n._binBE.i32[0]},readUint:function(t,r){var e=n._binBE.ui8;return e[0]=t[r+0],e[1]=t[r+1],e[2]=t[r+2],e[3]=t[r+3],n._binBE.ui32[0]},readASCII:n._binBE.readASCII,readFloat:function(t,r){for(var e=n._binBE.ui8,i=0;i<4;i++)e[i]=t[r+i];return n._binBE.fl32[0]},readDouble:function(t,r){for(var e=n._binBE.ui8,i=0;i<8;i++)e[i]=t[r+i];return n._binBE.fl64[0]},writeUshort:function(t,r,e){t[r]=255&e,t[r+1]=e>>8&255},writeInt:function(t,r,e){var i=n._binBE.ui8;n._binBE.i32[0]=e,t[r+0]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=i[3]},writeUint:function(t,r,e){t[r]=e>>>0&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},writeASCII:n._binBE.writeASCII},n._copyTile=function(t,r,e,n,i,a,o,f){for(var u=Math.min(r,i-o),l=Math.min(e,a-f),d=0;d<l;d++)for(var h=(f+d)*i+o,s=d*r,c=0;c<u;c++)n[h+c]=t[s+c]},t.LogLuvLoader=e,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],r):r((t="undefined"!=typeof globalThis?globalThis:t||self).THREE=t["THREE-STD"]||{},t.THREE)}();
