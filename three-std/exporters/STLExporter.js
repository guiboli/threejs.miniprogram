!function(){var e,t;e=this,t=function(e,t){"use strict";e.STLExporter=class{parse(e,o={}){const r=void 0!==o.binary&&o.binary,n=[];let i,s=0;e.traverse((function(e){if(e.isMesh){const t=e.geometry;if(!0!==t.isBufferGeometry)throw new Error("THREE.STLExporter: Geometry is not of type THREE.BufferGeometry.");const o=t.index,r=t.getAttribute("position");s+=null!==o?o.count/3:r.count/3,n.push({object3d:e,geometry:t})}}));let f=80;if(!0===r){const e=new ArrayBuffer(2*s+3*s*4*4+80+4);i=new DataView(e),i.setUint32(f,s,!0),f+=4}else i="",i+="solid exported\n";const l=new t.Vector3,a=new t.Vector3,u=new t.Vector3,c=new t.Vector3,d=new t.Vector3,p=new t.Vector3;for(let e=0,t=n.length;e<t;e++){const t=n[e].object3d,o=n[e].geometry,r=o.index,i=o.getAttribute("position");if(null!==r)for(let e=0;e<r.count;e+=3)y(r.getX(e+0),r.getX(e+1),r.getX(e+2),i,t);else for(let e=0;e<i.count;e+=3)y(e+0,e+1,e+2,i,t)}return!1===r&&(i+="endsolid exported\n"),i;function y(e,t,o,n,s){l.fromBufferAttribute(n,e),a.fromBufferAttribute(n,t),u.fromBufferAttribute(n,o),!0===s.isSkinnedMesh&&(s.boneTransform(e,l),s.boneTransform(t,a),s.boneTransform(o,u)),l.applyMatrix4(s.matrixWorld),a.applyMatrix4(s.matrixWorld),u.applyMatrix4(s.matrixWorld),function(e,t,o){c.subVectors(o,t),d.subVectors(e,t),c.cross(d).normalize(),p.copy(c).normalize(),!0===r?(i.setFloat32(f,p.x,!0),f+=4,i.setFloat32(f,p.y,!0),f+=4,i.setFloat32(f,p.z,!0),f+=4):(i+="\tfacet normal "+p.x+" "+p.y+" "+p.z+"\n",i+="\t\touter loop\n")}(l,a,u),m(l),m(a),m(u),!0===r?(i.setUint16(f,0,!0),f+=2):(i+="\t\tendloop\n",i+="\tendfacet\n")}function m(e){!0===r?(i.setFloat32(f,e.x,!0),f+=4,i.setFloat32(f,e.y,!0),f+=4,i.setFloat32(f,e.z,!0),f+=4):i+="\t\t\tvertex "+e.x+" "+e.y+" "+e.z+"\n"}}},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).THREE=e["THREE-STD"]||{},e.THREE)}();
