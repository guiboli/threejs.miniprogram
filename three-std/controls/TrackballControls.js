!function(){var e,t;e=this,t=function(e,t){"use strict";const o={type:"change"},n={type:"start"},c={type:"end"};class i extends t.EventDispatcher{constructor(e,i){super(),void 0===i&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),i===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const a=this,s=-1,r=0,p=1,d=2,m=3,l=4;this.object=e,this.domElement=i,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:t.MOUSE.ROTATE,MIDDLE:t.MOUSE.DOLLY,RIGHT:t.MOUSE.PAN},this.target=new t.Vector3;const h=1e-6,u=new t.Vector3;let y=1,g=s,b=s,E=0,f=0,w=0;const v=new t.Vector3,j=new t.Vector2,L=new t.Vector2,T=new t.Vector3,V=new t.Vector2,k=new t.Vector2,D=new t.Vector2,x=new t.Vector2,Y=[],C={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const e=a.domElement.getBoundingClientRect(),t=a.domElement.ownerDocument.documentElement;a.screen.left=e.left+window.pageXOffset-t.clientLeft,a.screen.top=e.top+window.pageYOffset-t.clientTop,a.screen.width=e.width,a.screen.height=e.height};const z=function(){const e=new t.Vector2;return function(t,o){return e.set((t-a.screen.left)/a.screen.width,(o-a.screen.top)/a.screen.height),e}}(),S=function(){const e=new t.Vector2;return function(t,o){return e.set((t-.5*a.screen.width-a.screen.left)/(.5*a.screen.width),(a.screen.height+2*(a.screen.top-o))/a.screen.width),e}}();function R(e){!1!==a.enabled&&(0===Y.length&&(a.domElement.setPointerCapture(e.pointerId),a.domElement.addEventListener("pointermove",X),a.domElement.addEventListener("pointerup",M)),function(e){Y.push(e)}(e),"touch"===e.pointerType?function(e){if(1===(F(e),Y.length))g=m,L.copy(S(Y[0].pageX,Y[0].pageY)),j.copy(L);else{g=l;const e=Y[0].pageX-Y[1].pageX,t=Y[0].pageY-Y[1].pageY;f=E=Math.sqrt(e*e+t*t);const o=(Y[0].pageX+Y[1].pageX)/2,n=(Y[0].pageY+Y[1].pageY)/2;D.copy(z(o,n)),x.copy(D)}a.dispatchEvent(n)}(e):function(e){if(g===s)switch(e.button){case a.mouseButtons.LEFT:g=r;break;case a.mouseButtons.MIDDLE:g=p;break;case a.mouseButtons.RIGHT:g=d}const t=b!==s?b:g;t!==r||a.noRotate?t!==p||a.noZoom?t!==d||a.noPan||(D.copy(z(e.pageX,e.pageY)),x.copy(D)):(V.copy(z(e.pageX,e.pageY)),k.copy(V)):(L.copy(S(e.pageX,e.pageY)),j.copy(L)),a.dispatchEvent(n)}(e))}function X(e){!1!==a.enabled&&("touch"===e.pointerType?function(e){if(1===(F(e),Y.length))j.copy(L),L.copy(S(e.pageX,e.pageY));else{const t=function(e){const t=e.pointerId===Y[0].pointerId?Y[1]:Y[0];return C[t.pointerId]}(e),o=e.pageX-t.x,n=e.pageY-t.y;f=Math.sqrt(o*o+n*n);const c=(e.pageX+t.x)/2,i=(e.pageY+t.y)/2;x.copy(z(c,i))}}(e):function(e){const t=b!==s?b:g;t!==r||a.noRotate?t!==p||a.noZoom?t!==d||a.noPan||x.copy(z(e.pageX,e.pageY)):k.copy(z(e.pageX,e.pageY)):(j.copy(L),L.copy(S(e.pageX,e.pageY)))}(e))}function M(e){!1!==a.enabled&&("touch"===e.pointerType?function(e){switch(Y.length){case 0:g=s;break;case 1:g=m,L.copy(S(e.pageX,e.pageY)),j.copy(L);break;case 2:g=l,L.copy(S(e.pageX-j.pageX,e.pageY-j.pageY)),j.copy(L)}a.dispatchEvent(c)}(e):(g=s,a.dispatchEvent(c)),q(e),0===Y.length&&(a.domElement.releasePointerCapture(e.pointerId),a.domElement.removeEventListener("pointermove",X),a.domElement.removeEventListener("pointerup",M)))}function P(e){q(e)}function I(e){!1!==a.enabled&&(window.removeEventListener("keydown",I),b===s&&(e.code!==a.keys[r]||a.noRotate?e.code!==a.keys[p]||a.noZoom?e.code!==a.keys[d]||a.noPan||(b=d):b=p:b=r))}function O(){!1!==a.enabled&&(b=s,window.addEventListener("keydown",I))}function A(e){if(!1!==a.enabled&&!0!==a.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:V.y-=.025*e.deltaY;break;case 1:V.y-=.01*e.deltaY;break;default:V.y-=25e-5*e.deltaY}a.dispatchEvent(n),a.dispatchEvent(c)}}function H(e){!1!==a.enabled&&e.preventDefault()}function q(e){delete C[e.pointerId];for(let t=0;t<Y.length;t++)if(Y[t].pointerId==e.pointerId)return void Y.splice(t,1)}function F(e){let o=C[e.pointerId];void 0===o&&(o=new t.Vector2,C[e.pointerId]=o),o.set(e.pageX,e.pageY)}this.rotateCamera=function(){const e=new t.Vector3,o=new t.Quaternion,n=new t.Vector3,c=new t.Vector3,i=new t.Vector3,s=new t.Vector3;return function(){s.set(L.x-j.x,L.y-j.y,0);let t=s.length();t?(v.copy(a.object.position).sub(a.target),n.copy(v).normalize(),c.copy(a.object.up).normalize(),i.crossVectors(c,n).normalize(),c.setLength(L.y-j.y),i.setLength(L.x-j.x),s.copy(c.add(i)),e.crossVectors(s,v).normalize(),t*=a.rotateSpeed,o.setFromAxisAngle(e,t),v.applyQuaternion(o),a.object.up.applyQuaternion(o),T.copy(e),w=t):!a.staticMoving&&w&&(w*=Math.sqrt(1-a.dynamicDampingFactor),v.copy(a.object.position).sub(a.target),o.setFromAxisAngle(T,w),v.applyQuaternion(o),a.object.up.applyQuaternion(o)),j.copy(L)}}(),this.zoomCamera=function(){let e;g===l?(e=E/f,E=f,a.object.isPerspectiveCamera?v.multiplyScalar(e):a.object.isOrthographicCamera?(a.object.zoom/=e,a.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(k.y-V.y)*a.zoomSpeed,1!==e&&e>0&&(a.object.isPerspectiveCamera?v.multiplyScalar(e):a.object.isOrthographicCamera?(a.object.zoom/=e,a.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),a.staticMoving?V.copy(k):V.y+=(k.y-V.y)*this.dynamicDampingFactor)},this.panCamera=function(){const e=new t.Vector2,o=new t.Vector3,n=new t.Vector3;return function(){if(e.copy(x).sub(D),e.lengthSq()){if(a.object.isOrthographicCamera){const t=(a.object.right-a.object.left)/a.object.zoom/a.domElement.clientWidth,o=(a.object.top-a.object.bottom)/a.object.zoom/a.domElement.clientWidth;e.x*=t,e.y*=o}e.multiplyScalar(v.length()*a.panSpeed),n.copy(v).cross(a.object.up).setLength(e.x),n.add(o.copy(a.object.up).setLength(e.y)),a.object.position.add(n),a.target.add(n),a.staticMoving?D.copy(x):D.add(e.subVectors(x,D).multiplyScalar(a.dynamicDampingFactor))}}}(),this.checkDistances=function(){a.noZoom&&a.noPan||(v.lengthSq()>a.maxDistance*a.maxDistance&&(a.object.position.addVectors(a.target,v.setLength(a.maxDistance)),V.copy(k)),v.lengthSq()<a.minDistance*a.minDistance&&(a.object.position.addVectors(a.target,v.setLength(a.minDistance)),V.copy(k)))},this.update=function(){v.subVectors(a.object.position,a.target),a.noRotate||a.rotateCamera(),a.noZoom||a.zoomCamera(),a.noPan||a.panCamera(),a.object.position.addVectors(a.target,v),a.object.isPerspectiveCamera?(a.checkDistances(),a.object.lookAt(a.target),u.distanceToSquared(a.object.position)>h&&(a.dispatchEvent(o),u.copy(a.object.position))):a.object.isOrthographicCamera?(a.object.lookAt(a.target),(u.distanceToSquared(a.object.position)>h||y!==a.object.zoom)&&(a.dispatchEvent(o),u.copy(a.object.position),y=a.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){g=s,b=s,a.target.copy(a.target0),a.object.position.copy(a.position0),a.object.up.copy(a.up0),a.object.zoom=a.zoom0,a.object.updateProjectionMatrix(),v.subVectors(a.object.position,a.target),a.object.lookAt(a.target),a.dispatchEvent(o),u.copy(a.object.position),y=a.object.zoom},this.dispose=function(){a.domElement.removeEventListener("contextmenu",H),a.domElement.removeEventListener("pointerdown",R),a.domElement.removeEventListener("pointercancel",P),a.domElement.removeEventListener("wheel",A),a.domElement.removeEventListener("pointermove",X),a.domElement.removeEventListener("pointerup",M),window.removeEventListener("keydown",I),window.removeEventListener("keyup",O)},this.domElement.addEventListener("contextmenu",H),this.domElement.addEventListener("pointerdown",R),this.domElement.addEventListener("pointercancel",P),this.domElement.addEventListener("wheel",A,{passive:!1}),window.addEventListener("keydown",I),window.addEventListener("keyup",O),this.handleResize(),this.update()}}e.TrackballControls=i,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).THREE=e["THREE-STD"]||{},e.THREE)}();
