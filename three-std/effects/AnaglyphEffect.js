!function(){var e,t;e=this,t=function(e,t){"use strict";e.AnaglyphEffect=class{constructor(e,r=512,o=512){this.colorMatrixLeft=(new t.Matrix3).fromArray([.4561,-.0400822,-.0152161,.500484,-.0378246,-.0205971,.176381,-.0157589,-.00546856]),this.colorMatrixRight=(new t.Matrix3).fromArray([-.0434706,.378476,-.0721527,-.0879388,.73364,-.112961,-.00155529,-.0184503,1.2264]);const i=new t.OrthographicCamera(-1,1,1,-1,0,1),a=new t.Scene,n=new t.StereoCamera,c={minFilter:t.LinearFilter,magFilter:t.NearestFilter,format:t.RGBAFormat},l=new t.WebGLRenderTarget(r,o,c),s=new t.WebGLRenderTarget(r,o,c),d=new t.ShaderMaterial({uniforms:{mapLeft:{value:l.texture},mapRight:{value:s.texture},colorMatrixLeft:{value:this.colorMatrixLeft},colorMatrixRight:{value:this.colorMatrixRight}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","uniform mat3 colorMatrixLeft;","uniform mat3 colorMatrixRight;","float lin( float c ) {","\treturn c <= 0.04045 ? c * 0.0773993808 :","\t\t\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );","}","vec4 lin( vec4 c ) {","\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );","}","float dev( float c ) {","\treturn c <= 0.0031308 ? c * 12.92","\t\t\t: pow( c, 0.41666 ) * 1.055 - 0.055;","}","void main() {","\tvec2 uv = vUv;","\tvec4 colorL = lin( texture2D( mapLeft, uv ) );","\tvec4 colorR = lin( texture2D( mapRight, uv ) );","\tvec3 color = clamp(","\t\t\tcolorMatrixLeft * colorL.rgb +","\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );","\tgl_FragColor = vec4(","\t\t\tdev( color.r ), dev( color.g ), dev( color.b ),","\t\t\tmax( colorL.a, colorR.a ) );","}"].join("\n")}),f=new t.Mesh(new t.PlaneGeometry(2,2),d);a.add(f),this.setSize=function(t,r){e.setSize(t,r);const o=e.getPixelRatio();l.setSize(t*o,r*o),s.setSize(t*o,r*o)},this.render=function(t,r){const o=e.getRenderTarget();t.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),n.update(r),e.setRenderTarget(l),e.clear(),e.render(t,n.cameraL),e.setRenderTarget(s),e.clear(),e.render(t,n.cameraR),e.setRenderTarget(null),e.render(a,i),e.setRenderTarget(o)},this.dispose=function(){l.dispose(),s.dispose(),f.geometry.dispose(),f.material.dispose()}}},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).THREE=e["THREE-STD"]||{},e.THREE)}();
